# PRD: AI ä¸“å®¶è¯„å®¡å›¢æµç¨‹é‡æ„ä¼˜åŒ–ä¸è½åœ°

> **ç‰ˆæœ¬**: 1.0
> **çŠ¶æ€**: Drafting
> **ä½œè€…**: Antigravity
> **å…³è”æ–‡æ¡£**: `docs/ai_expert_review_board_workflow_optimized.md` (æµç¨‹å›¾æº)

---

## 1. é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡ (Background & Goals)

### 1.1 èƒŒæ™¯ (Context)
å½“å‰çš„ AgentOS ç ”å‘æµç¨‹è™½ç„¶å…·å¤‡åŸºæœ¬çš„ `PRD -> Code` èƒ½åŠ›ï¼Œä½†åœ¨éœ€æ±‚è´¨é‡æ§åˆ¶å’ŒæŠ€æœ¯å¯è¡Œæ€§è¯„ä¼°ç¯èŠ‚å­˜åœ¨æ˜æ˜¾çŸ­æ¿ï¼š
1.  **ç¼ºä¹å‰ç½®è¿‡æ»¤**ï¼šæ— è®ºéœ€æ±‚å¤šä¹ˆç¦»è°±æˆ–æ¨¡ç³Šï¼ŒPM Agent éƒ½ä¼šå°è¯•ç”Ÿæˆ PRDï¼Œæµªè´¹ Token ä¸”äº§å‡ºä½è´¨ã€‚
2.  **ç¼ºå°‘æ·±åº¦è¯„å®¡**ï¼šç¼ºä¹å¤šè§†è§’ï¼ˆä½“éªŒã€ä¸šåŠ¡ã€æ‰¹åˆ¤ã€æŠ€æœ¯ï¼‰çš„å¹¶å‘è¯„å®¡æœºåˆ¶ï¼Œå®¹æ˜“äº§ç”Ÿç›²ç‚¹ã€‚
3.  **æŠ€æœ¯é£é™©æ»å**ï¼šå¾€å¾€åœ¨ä»£ç ç”Ÿæˆé˜¶æ®µæ‰å‘ç°æŠ€æœ¯ä¸å¯è¡Œæˆ–æˆæœ¬è¿‡é«˜ï¼Œå¯¼è‡´è¿”å·¥ã€‚

### 1.2 ç›®æ ‡ (Goals)
åŸºäºæœ€æ–°çš„ `ai_expert_review_board_workflow_optimized.md` æµç¨‹å›¾ï¼Œé‡æ„ç°æœ‰çš„éœ€æ±‚åˆ†æä¸è¯„å®¡ç¯èŠ‚ï¼Œå¼•å…¥â€œä¸“å®¶è¯„å®¡å›¢â€æœºåˆ¶ï¼Œå®ç°ä»¥ä¸‹ç›®æ ‡ï¼š
1.  **æ™ºèƒ½æ‹’å• (Smart Reject)**ï¼šé€šè¿‡å¯è¡Œæ€§æ£€æŸ¥å’Œæ¸…æ™°åº¦æ£€æŸ¥ï¼Œåœ¨æ—©æœŸæ‹¦æˆªä½è´¨éœ€æ±‚ã€‚
2.  **å¤šç»´è¯„å®¡ (Parallel Review)**ï¼šå¼•å…¥ UXã€Domainã€Criticã€Tech å››å¤§ä¸“å®¶è§’è‰²å¹¶å‘è¯„å®¡ã€‚
3.  **æŠ€æœ¯å…œåº• (Tech Gate)**ï¼šåœ¨ PRD ç¡®è®¤å‰å¢åŠ æˆæœ¬ä¼°ç®—ä¸å¿…è¦æ—¶çš„ POC (Proof of Concept) éªŒè¯ã€‚
4.  **è‡ªåŠ¨é—­ç¯ (Auto-Fix)**ï¼šåŸºäºè¯„å®¡æ„è§è‡ªåŠ¨ä¿®è®¢ PRDï¼Œå‡å°‘äººå·¥ä»‹å…¥ã€‚

---

## 2. æ ¸å¿ƒç”¨æˆ·æ•…äº‹ (User Stories)

| è§’è‰² | ç—›ç‚¹ / éœ€æ±‚ | æœŸæœ›ç»“æœ |
| :--- | :--- | :--- |
| **ç”¨æˆ· (User)** | æœ‰æ—¶æƒ³æ³•å¤ªå‘æ•£ï¼Œæˆ–è€…æè¿°ä¸æ¸…æ¥šï¼Œä¸å¸Œæœ› Agent ç›´æ¥çç¼–ä¹±é€ ã€‚ | Agent èƒ½åƒä¸“ä¸š PM ä¸€æ ·è¿½é—®ç»†èŠ‚ï¼Œæˆ–è€…ç›´æ¥å‘Šè¯‰æˆ‘è¿™ä¸å¯è¡Œï¼Œè€Œä¸æ˜¯æ•·è¡äº†äº‹ã€‚ |
| **ç”¨æˆ· (User)** | æ‹…å¿ƒåšå‡ºçš„åŠŸèƒ½è™½ç„¶èƒ½è·‘ï¼Œä½†æ˜¯åœ¨äº¤äº’æˆ–ä¸šåŠ¡é€»è¾‘ä¸Šæœ‰ç¡¬ä¼¤ã€‚ | æœ‰â€œä½“éªŒæ€»ç›‘â€å’Œâ€œè¡Œä¸šä¸“å®¶â€æŠŠå…³ï¼Œç¡®ä¿äº§å“ä¸ä»…èƒ½ç”¨ï¼Œè€Œä¸”å¥½ç”¨ã€ä¸“ä¸šã€‚ |
| **å¼€å‘è€… (Dev)** | ç»å¸¸é‡åˆ° PRD é‡Œçš„éœ€æ±‚æŠ€æœ¯å®ç°æˆæœ¬æé«˜ï¼Œæˆ–è€…æ ¹æœ¬æ— æ³•å®ç°ã€‚ | åœ¨å†™ä»£ç å‰ï¼Œæœ‰â€œæŠ€æœ¯ä¸“å®¶â€è¯„ä¼°å¯è¡Œæ€§ï¼Œå¿…è¦æ—¶å…ˆè·‘é€š POC å†å®šæ–¹æ¡ˆã€‚ |

---

## 3. è¯¦ç»†åŠŸèƒ½è¯´æ˜ (Detailed Implementation)

### 3.1 é˜¶æ®µä¸€ï¼šæ™ºèƒ½éœ€æ±‚å«å£« (Phase 1: The Gatekeeper)

#### 3.1.1 å¯è¡Œæ€§ä¸ä¸€è‡´æ€§æ£€æŸ¥ (Feasibility Check)
*   **è¾“å…¥**: ç”¨æˆ·åŸå§‹éœ€æ±‚ + `project_summary` (é¡¹ç›®æ ¸å¿ƒå®šä½)ã€‚
*   **é€»è¾‘**: 
    1.  åˆ¤æ–­éœ€æ±‚æ˜¯å¦ä¸¥é‡åç¦»äº§å“æ ¸å¿ƒå®šä½ï¼ˆé˜²æ­¢â€œåœ¨ç”µå•†Appé‡Œåšä¸ªæ“ä½œç³»ç»Ÿâ€ï¼‰ã€‚
    2.  åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ˜æ˜¾çš„æŠ€æœ¯å¤©èŠ±æ¿ï¼ˆå¦‚ï¼šP=NPé—®é¢˜ï¼‰æˆ–é«˜å±é£é™©ã€‚
*   **è¾“å‡º**: 
    *   `Pass`: è¿›å…¥ä¸‹ä¸€æ­¥ã€‚
    *   `Reject`: è¿”å›æ‹’ç»ç†ç”± (Structured Reason) + æ”¹è¿›å»ºè®®ã€‚
    *   `Ask`: å¦‚æœå­˜åœ¨æ­§ä¹‰ä½†æ€»ä½“å¯è¡Œï¼Œè¿›å…¥ **æ¾„æ¸…å¾ªç¯ (Clarification Loop)**ã€‚

#### 3.1.2 æ¸…æ™°åº¦æ£€æŸ¥ (Clarity Check)
*   **è¾“å…¥**: é€šè¿‡å¯è¡Œæ€§æ£€æŸ¥çš„éœ€æ±‚ã€‚
*   **é€»è¾‘**: è¯„ä¼°éœ€æ±‚æè¿°çš„å®Œæ•´åº¦ï¼ˆScore > 90%?ï¼‰ã€‚
*   **æ¾„æ¸…å¾ªç¯**:
    *   å¦‚æœåˆ†æ•° < 90%ï¼ŒAgent ç”Ÿæˆ `Clarification Questions`ã€‚
    *   ç”¨æˆ·å›ç­”åï¼Œç³»ç»Ÿæ›´æ–°éœ€æ±‚æè¿°ï¼Œ**é‡æ–°è§¦å‘** æ¸…æ™°åº¦æ£€æŸ¥ (Max Retries = 3)ã€‚
*   **è¾“å‡º**:
    *   `Pass`: ç”Ÿæˆ PRD åˆç¨¿ (ç²—è®¾) åŠåˆæ­¥ä¸šåŠ¡æµç¨‹å›¾ã€‚

### 3.2 é˜¶æ®µäºŒï¼šAI ä¸“å®¶è¯„å®¡å›¢ (Phase 2: The Expert Board)

æœ¬é˜¶æ®µç”± `Dispatcher` è§¦å‘ï¼Œ**å¹¶è¡Œ**å¤„ç† **PRD åˆç¨¿ (ç²—è®¾)**ã€‚

#### 3.2.1 è§’è‰²å®šä¹‰ (Roles)

| è§’è‰² | èŒè´£ (Responsibility) | å…³æ³¨ç‚¹ (Focus) | è¾“å‡ºç‰© (Artifact) |
| :--- | :--- | :--- | :--- |
| **ğŸ•µï¸ ä½“éªŒæ€»ç›‘ (UX Director)** | æ¨¡æ‹ŸæŒ‘å‰”çš„é«˜ç«¯ç”¨æˆ· | äº¤äº’æµç¨‹æ˜¯å¦é¡ºç•…ï¼ŸUIæ˜¯å¦ç¾è§‚ï¼Ÿæ˜¯å¦å­˜åœ¨åäººç±»è®¾è®¡ï¼Ÿ | `review_ux.md` |
| **ğŸ‘” äº§å“æ€»ç›‘ (Product Director)** | è´Ÿè´£æˆ˜ç•¥ä¸è·¯çº¿å›¾ | éœ€æ±‚æ˜¯å¦ç¬¦åˆé•¿æœŸæ„¿æ™¯ï¼ŸOKR å¯¹é½æƒ…å†µï¼Ÿä¼˜å…ˆçº§ P0/P1 åˆ†çº§ï¼Ÿ | `review_pd.md` |
| **ğŸ‘¨â€ğŸ« è¡Œä¸šä¸“å®¶ (Domain Expert)** | æ¨¡æ‹Ÿèµ„æ·±ä¸šåŠ¡é¡¾é—® | ä¸šåŠ¡é€»è¾‘æ˜¯å¦é—­ç¯ï¼Ÿæ˜¯å¦ç¬¦åˆè¡Œä¸šæ ‡å‡†ï¼Ÿå•†ä¸šä»·å€¼å¦‚ä½•ï¼Ÿ | `review_domain.md` |
| **ğŸ™… æ‰¹åˆ¤è€… (The Critic)** | æ¨¡æ‹Ÿé»‘å®¢æˆ–æç«¯ç”¨æˆ· | å¯»æ‰¾é€»è¾‘æ¼æ´ã€è¾¹ç¼˜æƒ…å†µ (Edge Cases)ã€å®‰å…¨éšæ‚£ã€‚ | `review_critic.md` |
| **ğŸ‘¨â€ğŸ’» æŠ€æœ¯ä¸“å®¶ (Tech Lead)** | æ¨¡æ‹Ÿæ¶æ„å¸ˆ | æŠ€æœ¯é€‰å‹æ˜¯å¦åˆç†ï¼Ÿæ”¹åŠ¨æˆæœ¬æ˜¯å¦è¿‡é«˜ï¼Ÿç°æœ‰æ¶æ„èƒ½å¦æ”¯æ’‘ï¼Ÿ | `review_tech.md` |

#### 3.2.2 æŠ€æœ¯ä¸“å®¶çš„ç‰¹æ®Šæµç¨‹ (Tech Logic)
*   **æˆæœ¬/é¢ è¦†æ€§æ£€æŸ¥ (Cost Check)**:
    *   å¦‚æœæ”¹åŠ¨æ¶‰åŠæ ¸å¿ƒåº•å±‚æ¶æ„æˆ–æˆæœ¬ > é˜ˆå€¼ï¼Œç›´æ¥è§¦å‘ `Tech Reject`ã€‚
*   **POC åˆ¤æ–­ (POC Decision)**:
    *   å¦‚æœæŠ€æœ¯è·¯çº¿ä¸ç¡®å®šï¼ˆå¦‚â€œæ¥å…¥æœªçŸ¥ APIâ€ã€â€œä½¿ç”¨æ–°æ¡†æ¶â€ï¼‰ï¼Œè§¦å‘ **å­å·¥ä½œæµ (Sub-Workflow)**ï¼š`POC Runner`ã€‚
    *   `POC Runner` **å¿…é¡»**åœ¨ä¸¥æ ¼æ²™ç®±ä¸­è¿è¡Œ (Sandbox Enforcement)ã€‚
    *   é™åˆ¶ï¼šç¦æ­¢å¤–ç½‘è®¿é—® (é™¤éç™½åå•)ã€æ‰§è¡Œè¶…æ—¶ (30s)ã€å†…å­˜é™åˆ¶ã€‚
    *   æ ¹æ® POC ç»“æœæ›´æ–° `review_tech.md`ã€‚

### 3.3 é˜¶æ®µä¸‰ï¼šä»²è£ä¸è‡ªæ„ˆ (Phase 3: Aggregation & Self-Healing)

#### 3.3.1 è¯„å®¡ä»²è£ (Aggregator)
*   **è¾“å…¥**: å››ä»½è¯„å®¡æŠ¥å‘Š (`review_*.md`)ã€‚
| **ä¼˜å…ˆçº§ (Arbitration Priority)**:
    1.  ğŸ”´ **Security & Safety** (Critic): ä¸€ç¥¨å¦å†³æƒã€‚ä»»ä½•é«˜å±æ¼æ´å¿…é¡»ä¿®å¤ã€‚
    2.  ğŸ”§ **Technical Feasibility** (Tech): ä¸€ç¥¨å¦å†³æƒã€‚åšä¸åˆ°å°±æ˜¯åšä¸åˆ°ã€‚
    3.  ğŸ‘” **Strategic Alignment** (Product Director): å†³å®š P0/P1/P2 ä¼˜å…ˆçº§ï¼Œä¸ç¬¦åˆè·¯çº¿å›¾çš„ P2 åŠŸèƒ½å¯ç æ‰ã€‚
    4.  ğŸ’° **Business Value** (Domain): å†³å®šæ˜¯å¦å€¼å¾—åšã€‚
    5.  âœ¨ **User Experience** (UX): åœ¨æ»¡è¶³å‰ä¸‰è€…åŸºç¡€ä¸Šçš„ä¼˜åŒ–ã€‚
*   **é€»è¾‘**: 
    1.  åˆå¹¶é‡å¤æ„è§ã€‚
    2.  è§£å†³å†²çªï¼ˆä¾æ®ä¼˜å…ˆçº§ï¼‰ã€‚
    3.  ç”Ÿæˆã€Šæœ€ç»ˆä¿®è®¢å»ºè®®ä¹¦ã€‹ã€‚

#### 3.3.2 è‡ªåŠ¨ä¿®è®¢ (PM Fix)
*   **è¡Œä¸º**: PM Agent è¯»å–ã€Šæœ€ç»ˆä¿®è®¢å»ºè®®ä¹¦ã€‹ï¼Œå¯¹ `PRD åˆç¨¿` (ç²—è®¾) è¿›è¡Œ rewriteã€‚
*   **äº§å‡º**: `PRD ç»ˆç¨¿` (v1.0) åŠå…¶å¯¹åº”çš„æœ€ç»ˆæµç¨‹å›¾ã€‚
*   **Gate 1**: ç”¨æˆ·æœ€ç»ˆç¡®è®¤ã€‚

### 3.4 é˜¶æ®µå››ï¼šäº¤ä»˜å‡†å¤‡ä¸æ‹†è§£ (Phase 4: Decomposition & Prep)

**è§¦å‘æ¡ä»¶**: ç”¨æˆ·é€šè¿‡ Gate 1 ç¡®è®¤ PRD ç»ˆç¨¿ã€‚

#### 3.4.1 å·¥ä½œé‡è¯„ä¼° (Workload Check)
*   **é€»è¾‘**: è¯„ä¼° PRD ç»ˆç¨¿çš„å¼€å‘å·¥ä½œé‡æ˜¯å¦ **> 1 äººæ—¥ (8h)**ã€‚
*   **åˆ†æ”¯åˆ¤å®š**:
    *   **Path A (â‰¤ 1 Day)**: è¿›å…¥ **ğŸš€ å¿«é€Ÿé€šé“ (Fast Track)**ã€‚
        *   PM è‡ªå®¡æˆ–ç›´æ¥ç”Ÿæˆå•ä¸€ä»»åŠ¡ Specã€‚
        *   è·³è¿‡ç¹çæ‹†è§£ï¼Œç›´æ¥è¿›å…¥å¼€å‘ã€‚
    *   **Path B (> 1 Day)**: è¿›å…¥ **ğŸ”ª PRD æ‹†è§£å­æµç¨‹ (Sub-Workflow 02)**ã€‚

#### 3.4.2 PRD æ‹†è§£å­æµç¨‹ (Decomposition Logic)
*   **æµç¨‹æº**: `docs/02_Workflow_Task_Decomposition.md`
*   **æ‰§è¡Œæ­¥éª¤**:
    1.  **å»ºç«‹ç›®å½•**: `docs/tasks/T-{ID}/`.
    2.  **åˆå§‹åŒ–æ¸…å• (Init Manifest)**: 
        *   **Top**: ç»˜åˆ¶ä¸šåŠ¡å…¨æ™¯å›¾ (Business Panorama) æˆ–å…³é”®æµç¨‹å›¾ã€‚
        *   **Bottom**: åˆ—å‡ºå­ä»»åŠ¡åˆ—è¡¨ (Checklist)ï¼ŒçŠ¶æ€ä¸º `[ ] Pending`ã€‚
    3.  **å¡«å……å†…å®¹ (Write Content)**: 
        *   é€ä¸ªæ’°å†™ Sub-PRD æ–‡æ¡£ã€‚
        *   æ ¹æ®éœ€æ±‚å¤æ‚åº¦ï¼Œå†³å®šæ˜¯å¦ç»˜åˆ¶å±€éƒ¨æµç¨‹å›¾ (Optional)ã€‚
    4.  **PM ç»ˆå®¡ (Final Audit)**:
        *   ä¸€è‡´æ€§æ£€æŸ¥ (Consistency) & è‡ªæ´½æ€§æ£€æŸ¥ (Self-Consistency)ã€‚
    5.  **ç”¨æˆ·ç®€æŠ¥ (User Brief)**:
        *   ç”Ÿæˆ `summary.md` (å«è¿›åº¦æ‘˜è¦ + Manifest é“¾æ¥)ã€‚
        *   **Gate 2**: ç”¨æˆ·ç¡®è®¤è¿›å…¥ç ”å‘é˜¶æ®µã€‚

*   **è¾“å‡º**: 
    *   `docs/tasks/T-{ID}/summary.md` (ç®€æŠ¥)
    *   `docs/tasks/T-{ID}/manifest.md` (ä»»åŠ¡æ¸…å• & å…¨æ™¯å›¾)
    *   `docs/tasks/T-{ID}/sub_prds/*.md` (å­æ–‡æ¡£)

---

## 4. äº¤ä»˜ç‰©æ¸…å• (Deliverables)

1.  **Prompts æ›´æ–°**:
    *   æ–°å¢ `role_ux_director.md`
    *   æ–°å¢ `role_domain_expert.md` 
    *   æ–°å¢ `role_critic.md`
    *   æ–°å¢ `role_tech_lead.md`
    *   æ›´æ–° `pm_agent.md` (å¢åŠ  Gatekeeper é€»è¾‘)
2.  **Workflow å®šä¹‰**:
    *   æ–°å»º `.agent/workflows/expert-review.md` (ä¸»æµç¨‹)ã€‚
    *   æ–°å»º `docs/prd_decomposition_workflow.md` (æ‹†è§£å­æµç¨‹)ã€‚
3.  **POC å·¥å…·é“¾**:
    *   æ”¯æŒ Agent åœ¨æ²™ç®±ç¯å¢ƒä¸­å¿«é€Ÿè¿è¡Œä¸´æ—¶ä»£ç  (Snippet Execution)ã€‚

## 5. éªŒæ”¶æ ‡å‡† (Acceptance Criteria)

1.  **æ‹¦æˆªæµ‹è¯•**: æ•…æ„æå‡ºç¦»è°±éœ€æ±‚ï¼Œç³»ç»Ÿåº”èƒ½æ‹’ç»ã€‚
2.  **æ¨¡ç³Šæµ‹è¯•**: æå‡ºæ¨¡ç³Šéœ€æ±‚ï¼Œç³»ç»Ÿåº”èƒ½è¿½é—®ç»†èŠ‚ã€‚
3.  **ä¸“å®¶æµ‹è¯•**: éªŒè¯ç²—è®¾ PRD ç»è¿‡äº†å››å¤§è§’è‰²çš„å®è´¨æ€§è¯„å®¡ã€‚
4.  **æ‹†è§£æµ‹è¯•**: 
    *   å¯¹äº > 1 å¤©çš„ä»»åŠ¡ï¼Œç³»ç»Ÿå¿…é¡»ç”Ÿæˆç‹¬ç«‹çš„ Sub-PRD æ–‡ä»¶å¤¹ç»“æ„ã€‚
    *   Sub-PRD å¿…é¡»åŒ…å«æŒ‡å‘çˆ¶ PRD çš„å¼•ç”¨ï¼Œä¸”é€»è¾‘ä¸å†²çªã€‚
    *   å¿…é¡»åŒ…å«å…¨å±€è§†è§’çš„æµç¨‹å›¾ã€‚
5.  **POC æµ‹è¯•**: (é«˜å±) éªŒè¯ POC Runner çš„æ²™ç®±é€ƒé€¸é˜²æŠ¤èƒ½åŠ›ã€‚

---

> **Note**: æµç¨‹å›¾è§æ–‡æ¡£ `docs/ai_expert_review_board_workflow_optimized.md`ã€‚
